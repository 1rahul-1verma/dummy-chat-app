(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],[,,,function(e,t,n){e.exports={ROOT_URL:"https://chat-server-dummy-app.herokuapp.com/",MESSAGE_FILE:"/Users/rahul/Desktop/Practice/dummy-chat/src/Server/message.json",USER_FILE:"/Users/rahul/Desktop/Practice/dummy-chat/src/Server/user.json",CHAT_FILE:"/Users/rahul/Desktop/Practice/dummy-chat/src/Server/chat.json",BASE_URL:"http://localhost:3001"}},,,,,,,,,,,,function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),s=n(10),r=n.n(s),o=(n(15),n(2)),i=n(3).ROOT_URL,l=function(e){var t=e.url,n=e.method,c=e.payload,s=e.skip,r=void 0!==s&&s,l=e.interval,d=Object(a.useState)(),u=Object(o.a)(d,2),j=u[0],m=u[1],h=Object(a.useState)(),b=Object(o.a)(h,2),O=b[0],v=b[1],f=Object(a.useState)(!r),x=Object(o.a)(f,2),p=x[0],g=x[1],S=Object(a.useState)(0),N=Object(o.a)(S,2),C=N[0],I=N[1],k=Object(a.useCallback)((function(){var e={method:n};c&&Object.assign(e,{body:JSON.stringify(c),headers:{"Content-Type":"application/json"}}),g(!0),fetch(i+t,e).then((function(e){return e.ok||v("Some Error"),e.json()})).then((function(e){m(e),g(!1)})).catch((function(e){g(!1),v("".concat(e))}))}),[t,n,c]);return Object(a.useEffect)((function(){r||k()}),[k,r,C]),Object(a.useEffect)((function(){if(l){var e=setInterval((function(){I(Date.now())}),500);return function(){clearInterval(e)}}return function(){}})),{data:j,error:O,loading:p,fetchCallback:k}},d=(n(16),n(0));function u(){var e=Object(a.useContext)(U),t=l({url:"user/id?userId=".concat(e),method:"GET"}),n=t.data,c=t.loading;return Object(d.jsxs)("div",{className:"header-container",children:[Object(d.jsx)("input",{className:"search-box",placeholder:"Search...",type:"text"}),Object(d.jsx)("div",{className:"user",children:c||!n?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("div",{className:"user-name",children:" Loading... "}),Object(d.jsx)("div",{className:"loading-user-avatar",children:" "})]}):Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("div",{className:"user-name",children:[" ",n.name," "]}),Object(d.jsx)("img",{className:"user-avatar",src:n.avatar,alt:"AVATAR"})]})})]})}n(18);var j=c.a.memo((function(){return Object(d.jsx)("div",{className:"side-header-container",children:"Sprinklr"})})),m=(n(19),c.a.memo((function(e){var t=e.chatId,n=e.handleSelectedChatId,a=l({url:"chat/id?chatId=".concat(t),method:"GET"}),c=a.data,s=a.loading;return Object(d.jsx)(d.Fragment,{children:s?Object(d.jsx)("div",{children:" Loading... "}):Object(d.jsx)("div",{className:"chat-option-container",onClick:function(){return function(e){e&&n(e.id)}(c)},children:null===c||void 0===c?void 0:c.name})})}))),h=(n(20),c.a.memo((function(e){var t=e.channels,n=e.SelectedChannel,a=e.handleSelectedChannelId,c=e.handleFormOpen;return Object(d.jsxs)("div",{className:"channel-container",children:[Object(d.jsx)("p",{className:"channel-header",children:"Channels"}),null===t||void 0===t?void 0:t.map((function(e,t){return Object(d.jsx)("div",{className:"channel","data-selected":n===e,children:Object(d.jsx)(m,{chatId:e,handleSelectedChatId:a})},t)})),Object(d.jsx)("div",{className:"channel-button",onClick:c,children:" Add channels "})]})}))),b=(n(21),c.a.memo((function(e){var t=e.friends,n=e.SelectedFriend,a=e.handleSelectedFriendId;return Object(d.jsxs)("div",{className:"friend-container",children:[Object(d.jsx)("p",{className:"message-header",children:"Direct Messages"}),null===t||void 0===t?void 0:t.map((function(e,t){return Object(d.jsx)("div",{className:"friend","data-selected":n===e,children:Object(d.jsx)(m,{chatId:e,handleSelectedChatId:a})},t)}))]})})));n(22);function O(e){var t=e.selectedListItem,n=e.handleSelectedListItem,c=e.handleFormOpen,s=Object(a.useContext)(U),r=l({url:"user/id?userId=".concat(s),method:"GET",interval:!0}).data;return Object(d.jsxs)("div",{className:"sidepanel-container",children:[Object(d.jsx)(j,{}),Object(d.jsx)(h,{SelectedChannel:t,channels:null===r||void 0===r?void 0:r.channels,handleSelectedChannelId:n,handleFormOpen:c}),Object(d.jsx)(b,{SelectedFriend:t,friends:null===r||void 0===r?void 0:r.directMessages,handleSelectedFriendId:n})]})}var v=n(5),f=n.n(v),x=n(8),p=n(4),g=(n(24),c.a.memo((function(e){var t,n=e.sender,a=e.message,c=l({url:"message/id?messageId=".concat(a),method:"GET"}),s=c.data,r=c.loading,o=l({url:"user/id?userId=".concat(null===s||void 0===s?void 0:s.senderId),method:"GET"}),i=o.data,u=o.loading;return Object(d.jsx)("div",{className:"message-container",children:Object(d.jsxs)("div",{className:"message","data-sender":n===(null===s||void 0===s?void 0:s.senderId),children:[Object(d.jsx)("div",{children:u||!i?Object(d.jsx)("div",{className:"loading-avatar"}):Object(d.jsx)("img",{className:"message-avatar",src:i.avatar,alt:"avatar"})}),Object(d.jsxs)("div",{className:"message-content-container",children:[u||!i?Object(d.jsx)("div",{className:"sender-name-loading",children:" "}):Object(d.jsxs)("div",{className:"sender-name",children:[i.name," : ",(t=null===s||void 0===s?void 0:s.timeStamp,t?new Date(parseInt(t)).toLocaleTimeString().slice(0,5):"")]}),r||!s?Object(d.jsx)("div",{className:"message-content-loading"}):Object(d.jsx)("div",{className:"message-content",children:s.content})]})]})})}))),S=(n(25),c.a.memo((function(e){var t=e.sender,n=e.messages,a=e.onScroll;return Object(d.jsxs)("div",{className:"chat-body-container",onScroll:a,children:[console.log(n),n&&n.map((function(e){return Object(d.jsx)(g,{sender:t,message:e},e)}))]})}))),N=function(e){var t=Object(a.useState)(!1),n=Object(o.a)(t,2),c=n[0],s=n[1],r=Object(a.useState)(),i=Object(o.a)(r,2),l=i[0],d=i[1],u=Object(a.useState)(),j=Object(o.a)(u,2),m=j[0],h=j[1];return{mutate:function(){var t=Object(x.a)(f.a.mark((function t(n){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s(!0),e(n).then((function(e){return e.ok||h("Some Error"),e.json()})).then((function(e){d(e),s(!1)})).catch((function(e){s(!1),h("".concat(e))}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),data:l,loading:c,error:m}},C=function(e,t){var n=function(e){return{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}}(e);return fetch(t,n)},I=(n(26),n(3).ROOT_URL),k=c.a.memo((function(e){var t=e.sender,n=e.activeChatId,c=Object(a.useState)(""),s=Object(o.a)(c,2),r=s[0],i=s[1],l=N((function(e){var t="".concat(I,"message");return C(e,t)})).mutate,u=N((function(e){var t="".concat(I,"chat/id");return C(e,t)})).mutate;return Object(d.jsxs)("div",{className:"messageBox-container",children:[Object(d.jsx)("textarea",{className:"messageBox-input",placeholder:"Type Message...",value:r,onChange:function(e){var t=e.target.value;i(t)}}),Object(d.jsx)("button",{disabled:""===r,className:"message-box-button",onClick:function(){var e=Date.now().toString();l({id:e,senderId:t,content:r,timeStamp:e}),u({chatId:n,messageId:e}),i("")},children:"Send"})]})})),y=(n(27),c.a.memo((function(e){var t=e.activeChat,n=e.type,a=e.handleFormOpen;return Object(d.jsxs)("div",{className:"chat-header-container",children:[t,"2"===n&&Object(d.jsx)("button",{className:"add-channel-button",onClick:a,children:"+"})]})}))),F=n(3),T=c.a.memo((function(e){var t=e.isFormOpen,n=e.chatId,c=e.handleFormClose,s=Object(a.useState)(""),r=Object(o.a)(s,2),i=r[0],l=r[1],u=N((function(e){var t="".concat(F.ROOT_URL,"chat/newUser");return C(e,t)})).mutate,j=N((function(e){var t="".concat(F.ROOT_URL,"user");return C(e,t)})).mutate;return Object(d.jsx)(d.Fragment,{children:t&&Object(d.jsx)("div",{className:"overlay",children:Object(d.jsxs)("div",{className:"form",children:[Object(d.jsx)("h2",{children:"Add new member!"}),Object(d.jsx)("label",{className:"form-label",children:" New Member "}),Object(d.jsx)("input",{className:"form-input",value:i,placeholder:"New Member",onChange:function(e){var t=e.target.value;l(t)},required:!0}),Object(d.jsx)("button",{className:"form-button-close",onClick:c,children:"X"}),Object(d.jsx)("button",{className:"form-button-create",onClick:function(){c();var e={chatId:n,userId:i};u(e),j(e)},children:"Add"})]})})})})),E=function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),n=t[0],c=t[1];return{isModalOpen:n,toggleModalState:Object(a.useCallback)((function(){c((function(e){return!e}))}),[])}},L=(n(28),function(e){var t=e.activeChatId,n=Object(a.useContext)(U),c=Object(a.useState)([]),s=Object(o.a)(c,2),r=s[0],i=s[1],u=l({url:"chat/id?chatId=".concat(t),method:"GET"}).data,j=l({url:"chat/page?chatId=".concat(t,"&lastMessage=").concat(r.length?r[r.length-1]:0),method:"GET",skip:!1}).data,m=l({url:"chat/chatAfter?chatId=".concat(t,"&lastMessage=").concat((null===r||void 0===r?void 0:r.length)?r[0]:-1),method:"GET",skip:!1,interval:!0}).data;Object(a.useEffect)((function(){var e=(null===u||void 0===u?void 0:u.messages)?Object(p.a)(null===u||void 0===u?void 0:u.messages):[];e.reverse(),i(e)}),[u]),Object(a.useEffect)((function(){m&&(console.log("here"),i((function(e){return[].concat(Object(p.a)(m),Object(p.a)(e))})))}),[m]);var h=E(),b=h.isModalOpen,O=h.toggleModalState,v=function(){var e=Object(x.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:0===t.currentTarget.scrollTop&&((n=j?Object(p.a)(j):[]).reverse(),i((function(e){return[].concat(Object(p.a)(e),Object(p.a)(n))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)("div",{className:"chat-area",children:[Object(d.jsx)(y,{activeChat:null===u||void 0===u?void 0:u.name,type:null===u||void 0===u?void 0:u.type,handleFormOpen:O}),Object(d.jsx)(S,{sender:n,messages:r,onScroll:v}),Object(d.jsx)(k,{sender:n,activeChatId:t}),Object(d.jsx)(T,{chatId:t,isFormOpen:b,handleFormClose:O})]})}),M=(n(29),c.a.memo((function(e){var t=e.isOpen,n=e.onClose,c=Object(a.useState)(""),s=Object(o.a)(c,2),r=s[0],i=s[1],l=Object(a.useState)(""),u=Object(o.a)(l,2),j=u[0],m=u[1],h=N((function(e){var t="".concat(F.ROOT_URL,"chat/new");return C(e,t)})).mutate,b=N((function(e){var t="".concat(F.ROOT_URL,"user");return C(e,t)})).mutate;return Object(d.jsx)(d.Fragment,{children:t?Object(d.jsx)("div",{className:"overlay",children:Object(d.jsxs)("div",{className:"form",children:[Object(d.jsx)("h2",{children:"Create a channel"}),Object(d.jsx)("label",{className:"form-label",children:" Name "}),Object(d.jsx)("input",{className:"form-input",placeholder:"Channel-Name",value:r,onChange:function(e){return function(e){var t=e.target.value;i(t)}(e)},name:"name",required:!0}),Object(d.jsx)("label",{className:"form-label",children:" Members "}),Object(d.jsx)("input",{className:"form-input",placeholder:"Members-List",value:j,onChange:function(e){return function(e){var t=e.target.value;m(t)}(e)},required:!0}),Object(d.jsx)("button",{className:"form-button-close",onClick:n,children:"X"}),Object(d.jsx)("button",{className:"form-button-create",onClick:function(){n();var e=j.split(","),t=Date.now().toString(),a={id:t,name:r,userId:e,messages:[],type:"2"};e.forEach((function(e){var n={chatId:t,userId:e};console.log(n),b(n)})),h(a)},children:"Create"})]})}):null})}))),R=(n(30),c.a.memo((function(){var e=Object(a.useState)(""),t=Object(o.a)(e,2),n=t[0],c=t[1],s=E(),r=s.isModalOpen,i=s.toggleModalState,l=Object(a.useCallback)((function(e){c(e)}),[]);return Object(d.jsxs)("div",{className:"body-container",children:[Object(d.jsx)(O,{selectedListItem:n,handleSelectedListItem:l,handleFormOpen:i}),Object(d.jsx)(L,{activeChatId:n}),Object(d.jsx)(M,{isOpen:r,onClose:i})]})}))),w=prompt("Enter name to join"),U=c.a.createContext("");function _(){return Object(d.jsxs)(U.Provider,{value:w,children:[Object(d.jsx)(u,{}),Object(d.jsx)(R,{})]})}var A=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,32)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),s(e),r(e)}))};r.a.render(Object(d.jsx)(c.a.StrictMode,{children:Object(d.jsx)(_,{})}),document.getElementById("root")),A()}],[[31,1,2]]]);
//# sourceMappingURL=main.d3cb094f.chunk.js.map